SELECT  coalesce(nullif(trim(pt.client_id),''),'-9999') as client_id,coalesce(nullif(pt.participant_id,''),'-9999') as participant_id,coalesce(nullif(pt.plan_number,''),'-9999') as plan_number,coalesce(nullif(pt.retirement_account_id,''),'-9999') as retirement_account_id,pt.plan_reference_key,pt.source_system,pt.part_product_id,pt.part_acc_plan_code as plan_code,pt.age,pt.part_acct_status_date,pt.part_type,case when pt.plan_entry_date >= to_date('0001-01-01') and pt.plan_entry_date <= to_date('9999-12-31') then cast(pt.plan_entry_date as date) else null end as plan_entry_date,pt.participant_tin as part_ssn,pt.participant_tin_last_four as part_ssn_last_4,pt.birth_date,pt.attained_age,pt.part_gender_code as gender_code,pt.sex as gender_desc,case when pt.part_gender_code in ('M','F') then 'Y' end as  pt.part_person_flag,pt.participant_first_name as first_name,pt.participant_last_name as last_name,pt.part_suffix as name_suffix,pt.participant_address_line_1 as part_address_line_1,pt.participant_address_line_2 as part_address_line_2,pt.participant_address_line_3 as part_address_line_3,pt.participant_address_city as part_address_city,pt.participant_address_state as part_address_state,pt.participant_address_zip_code as part_address_zip_code,pt.country_name,pt.part_line_of_business as line_of_business,pt.processing_date,pt.ee_contrib_401k_state_tax_flag,pt.ee_contrib_401k_current_year,pt.ee_contrib_401k_prior_year,pt.eligibility_5500_date,pt.account_inception_date,pt.addl_high_outst_loan_balance as highest_outstand_loan_balance,pt.address_validity,pt.advice_account_indicator,pt.advice_account_rebal_freq,pt.advice_target_message_1,pt.advice_target_message_2,pt.advice_target_message_3,pt.alternate_taxability_state,pt.alternate_vesting_date,pt.annual_dist_amount,pt.annual_salary,pt.auto_enrollment_date,pt.auto_enrollment_indicator,pt.automatic_increase_flag,pt.beneficiary_code,pt.brokerage_account_number,pt.client_pass_thru_identifier,pt.client_status,pt.contribution_415_current,pt.contribution_415_prior,pt.death_benefit_percentage,pt.death_date,pt.default_deferral_flag,pt.default_enrolled_qdia,pt.default_investment_flag,pt.defer_date,pt.deferral_grouping_id,pt.demographic_effective_date,pt.div_pass_thru_indicator as dividend_pass_thru_indicator,pt.div_sub_id,pt.dividend_pass_thru_election,pt.divid_pass_thru_election_pct as dividend_pass_thru_election_pct,pt.dollar5000_reached_date,pt.ee_contrib_taxed_by_state,pt.egtrra_target_message_id,pt.eligibility_completion_date,pt.eligibility_date,pt.eligibility_exclusion,pt.eligibility_reminder_date,pt.eligible_for_bonus,pt.eligible_for_distribution_date,pt.elig_rollover_distributions,pt.email_address,pt.employee_number,pt.employee_number_2,pt.alternate_account_number,pt.employment_date,pt.employment_status_reason,pt.enrollment_date,pt.equity_wash_amount,pt.er_after_tax as er_after_tax_amount,pt.esop_diversification_shares,case when pt.excess_trader_suspend_end_date >= to_date('0001-01-01') and pt.excess_trader_suspend_end_date <= to_date('9999-12-31') then cast(pt.excess_trader_suspend_end_date as date) else null end as excess_trader_suspend_end_date,pt.excess_trader_suspend_flag,pt.excess_trader_susp_start_date,case when pt.federal_part_marital_status in ('0','1','4') then 'N' when pt.federal_part_marital_status  in ('2','3') then 'Y' end  as marital_status_code,pt.federal_w4p_form_status,pt.financial_engins_prospect_code,case when pt.first_contribution_date >= to_date('0001-01-01') and pt.first_contribution_date <= to_date('9999-12-31') then cast(pt.first_contribution_date as date) else null end as first_contribution_date,pt.first_default_contrib_date,pt.flag_16B,pt.foreign_country_code,pt.free_look_end_date,pt.group_payment_status_flag,pt.hce_indicator,pt.high_loan_balance_amount,pt.highly_compensated_ee_flag,pt.hours_of_service,pt.human_resouce_status_code as human_resource_status_code,pt.ilip_equity_wash_residual_amt,pt.init_partial_term_dist_date,pt.init_rollover_dist_date,pt.key_employee_indicator,pt.language_print_preference,pt.last_alloc_pct_change_date,pt.last_contrib_rate_change_date,pt.last_contribution_amt_gross,pt.last_contribution_date,pt.last_hardship_withdrawal_date,pt.last_loan_default_date,pt.last_plan_to_plan_transf_date,pt.last_transfer_date,case when pt.leave_of_absense_end_date >= to_date('0001-01-01') and pt.leave_of_absense_end_date <= to_date('9999-12-31') then cast(pt.leave_of_absense_end_date as date) else null end as leave_of_absense_end_date,pt.lifetime_dsc_amount,pt.managed_acct_salary_at_enroll,pt.match_payroll_generic_grouping,pt.min_distrib_begin_time_option as min_distrib_begin_date_option ,pt.min_distrib_calculation_method,pt.min_distrib_eligibility_date,pt.min_distrib_suppress_option,pt.mva_charged_to_date,pt.net_401k_elective_deferrals,case when pt.next_rebalance_date >= to_date('0001-01-01') and pt.next_rebalance_date <= to_date('9999-12-31') then cast(pt.next_rebalance_date as date) else null end as next_rebalance_date,pt.nonqual_ind,pt.old_advice_account,pt.oracle_plan_rule_id,pt.override_withholding as withholding_override,pt.override_withholding_amount as withholding_amount_override,pt.override_withholding_pct as withholding_pct_override,pt.part_acc_prod_code as product_code,pt.part_acc_prod_shrt_nm as product_name,pt.part_agg_sys_key as agg_sys_key,pt.part_location_code as location_code,pt.part_middle_name as middle_name,pt.part_payrole_location as payroll_location,pt.part_phone as phone,pt.part_post88_surender as post88_surender,pt.part_roth_year as roth_year,pt.part_ytd_hours_worked as ytd_hours_worked,pt.participant_16b_status as status_16B,pt.participant_account_status_desc as part_status_desc,pt.participant_account_type as account_type,pt.participant_account_type_code as account_type_code,pt.participant_account_type_desc as account_type_code_desc,pt.participant_address_line_4 as part_address_line_4,pt.participant_catchup_eligible as catchup_eligible_flag,pt.participant_employee_id as employee_id,case when pt.participant_fe_end_date >= to_date('0001-01-01') and pt.participant_fe_end_date <= to_date('9999-12-31') then cast(pt.participant_fe_end_date as date) else null end as fe_end_date,pt.participant_fe_start_date as fe_start_date,pt.participant_hce_status as hce_status,pt.participant_installment_status as installment_status,pt.participant_marital_status as marital_status_code_desc,pt.participant_name_formatted as name_formatted,pt.participant_person_flag as person_flag,pt.participant_qdro_status as qdro_status,pt.participant_status_code,pt.pay_group_id,pt.payroll_frequency,pt.periods_of_continuous_service,pt.plan_year_compensation_current,pt.group_iv_id,pt.plan_year_compensation_prior,pt.post1986_ee_aftertax_contrib,pt.pre_tax_401k_contrib_current,pt.pre_tax_401k_contrib_prior,pt.pre1987_ee_aftertax_contrib,pt.prior_hce_indicator,pt.puerto_rico_resident,case when pt.qdia_date >= to_date('0001-01-01') and pt.qdia_date <= to_date('9999-12-31') then cast(pt.qdia_date as date) else null end as qdia_date,pt.qdia_indicator,pt.qdro_beneficary_actual_ssn as qdro_beneficary_ssn,pt.qdro_flag,pt.reduction_401k_option,case when pt.reinstatement_notify_date >= to_date('0001-01-01') and pt.reinstatement_notify_date <= to_date('9999-12-31') then cast(pt.reinstatement_notify_date as date) else null end as reinstatement_notify_date,pt.related_participant_id,pt.roll_account_type,pt.roll_contribution_current_year,pt.roll_contribution_prior_year,pt.roth_deferral_contributions,case when pt.roth_first_contribution_date >= to_date('0001-01-01') and pt.roth_first_contribution_date <= to_date('9999-12-31') then cast(pt.roth_first_contribution_date as date) else null end as roth_first_contribution_date,pt.roth_iprr_contributions,pt.roth_sma_account_number,pt.roth_unrestricted_contrib,pt.sdbo_hold_harmless,case when pt.sma_fund_balance = '1             0.0' or pt.sma_fund_balance = '1             0.' then 0.00 else pt.sma_fund_balance end as sma_fund_balance,pt.source_adj_vest_percent,pt.source_cycle_date,pt.spouse_consent_expiration_date,case when pt.spouse_birth_date >= to_date('0001-01-01') and pt.spouse_birth_date <= to_date('9999-12-31') then cast(pt.spouse_birth_date as date) else null end as spouse_birth_date,pt.spouse_name,pt.suspension_date,pt.suspension_months_ee_contrib,pt.suspension_months_er_contrib,pt.suspension_months_forf_realloc,pt.tax_treaty_country_code,pt.termination_date,case when pt.termination_notification_date >= to_date('0001-01-01') and pt.termination_notification_date <= to_date('9999-12-31') then cast(pt.termination_notification_date as date) else null end as termination_notification_date,pt.termination_reason_code,pt.total_number_of_funds,pt.trade_activity,pt.very_important_person_indicat,pt.withdrawal_restriction,pt.withdrawal_restriction_reason,pt.inside_trading_16b_restrict_id,case when pt.last_crc_rate_chg_dt >= to_date('0001-01-01') and pt.last_crc_rate_chg_dt <= to_date('9999-12-31') then cast(pt.last_crc_rate_chg_dt as date) else null end as last_crc_rate_chg_dt,pt.term_stat_reason_code,pt.cntrbs_txd_by_st_flg as state_contrib_taxed_by_flag,pt.ee_cntrb_pty as ee_contrib_prior_tax_year,pt.ee_cntrb_ytd as ee_contrib_ytd,pt.ytd_contributions,cust.cust_ods_agreement_id from participant_temp as pt left outer join ods_retirement_account as cust on coalesce(pt.plan_number,'-9999') = coalesce(cust.plan_number,'-9999') and coalesce(pt.participant_id,'-9999') = coalesce(cust.participant_id,'-9999')
