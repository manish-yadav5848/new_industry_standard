select coalesce(nullif(trim(n.part_acct_client_id),'') ,nullif(trim(q1.client_id),''),'-9999') as client_id,coalesce(n.plan_number,lmia.plan_number,-9999) as plan_number, coalesce(n.participant_acc_number,lmia.policy_number,-9999) as participant_id,  coalesce(n.participant_acc_ref_key,-9999) as retirement_account_id,coalesce(n.part_acc_company_code,lmia.company_code) as part_acc_company_code , coalesce(n.part_acc_source_system,lmia.source_system) as source_system, n.part_product_code as part_product_id, n.part_acc_plan_code, n.part_acc_status as participant_status, n.part_acc_status_text, cast(n.part_acct_status_date as DATE), n.part_type, cast(n.part_acc_plan_entry_date as DATE) as plan_entry_date, n.participant_tin, n.participant_tin_last_4 as participant_tin_last_four,round(DATEDIFF(day,n.participant_dob,current_date())/365.25 , 1) AS age,n.plan_reference_key, cast(n.participant_dob as DATE) as birth_date, cast(n.part_age as DECIMAL(7,2)) as attained_age, n.part_gender_code,cast(null as VARCHAR(25)) as div_sub_id, n.part_gender_text as sex, n.part_person_flag, n.part_full_name as participant_name_raw, n.part_first_name as participant_first_name, n.part_last_name participant_last_name, n.part_suffix, n.part_addr_line1 as participant_address_line_1, n.part_addr_line2 as participant_address_line_2, n.part_addr_line3 as participant_address_line_3, n.part_addr_city as participant_address_city, n.part_addr_state as participant_address_state, n.part_addr_postal_code as participant_address_zip_code, n.part_addr_country as country_name, n.part_lob as part_line_of_business, cast(lmia.process_date as DATE) as processing_date, lmia.soc_sec_no as social_security_number, cast(null as INTEGER) as marital_status, cast(null as INTEGER) as ee_contrib_401k_state_tax_flag, cast(null as DECIMAL(11,2)) as ee_contrib_401k_current_year, cast(null as DECIMAL(11,2)) as ee_contrib_401k_prior_year, cast(null as DATE) as eligibility_5500_date, cast(null as DATE) as account_inception_date, cast(null as VARCHAR(01)) as account_type, cast(null as DECIMAL(11,2)) as addl_high_outst_loan_balance, cast(null as VARCHAR(01)) as address_validity, cast(null as INTEGER) as advice_account_indicator, cast(null as VARCHAR(01)) as advice_account_rebal_freq, cast(null as INTEGER) as advice_target_message_1, cast(null as INTEGER) as advice_target_message_2, cast(null as INTEGER) as advice_target_message_3, cast(null as VARCHAR(02)) as alternate_taxability_state, cast(null as DATE) as alternate_vesting_date, cast(null as DECIMAL(11,2)) as annual_dist_amount, cast(null as DECIMAL(11,2)) as annual_salary, cast(null as DATE) as auto_enrollment_date, cast(null as VARCHAR(10)) as auto_enrollment_indicator, cast(null as VARCHAR(01)) as automatic_increase_flag, cast(null as VARCHAR(01)) as beneficiary_code, cast(null as VARCHAR(20)) as brokerage_account_number, cast(null as VARCHAR(10)) as client_pass_thru_identifier, cast(null as VARCHAR(10)) as client_status, cast(null as VARCHAR(10)) as code2, cast(null as DECIMAL(11,2)) as contribution_415_current, cast(null as DECIMAL(11,2)) as contribution_415_prior, cast(null as INTEGER) as death_benefit_percentage, cast(null as DATE) as death_date, cast(null as VARCHAR(01)) as default_deferral_flag, cast(null as VARCHAR(1)) as default_enrolled_qdia, cast(null as VARCHAR(01)) as default_investment_flag, cast(null as DATE) as defer_date, cast(null as VARCHAR(04)) as deferral_grouping_id, cast(null as DATE) as demographic_effective_date, cast(null as DECIMAL(4,1)) as div_pass_thru_indicator, cast(null as DECIMAL(5,4)) as dividend_pass_thru_election, cast(null as DECIMAL(4,1)) as divid_pass_thru_election_pct, cast(null as DATE) as dollar5000_reached_date, cast(null as INTEGER) as ee_contrib_taxed_by_state, cast(null as INTEGER) as egtrra_target_message_id, cast(null as DATE) as eligibility_completion_date, cast(null as DATE) as eligibility_date, cast(null as VARCHAR(01)) as eligibility_exclusion, cast(null as DATE) as eligibility_reminder_date, cast(null as VARCHAR(01)) as eligible_for_bonus, cast(null as DATE) as eligible_for_distribution_date, cast(null as DECIMAL(11,2)) as elig_rollover_distributions, cast(null as VARCHAR(80)) as email_address, cast(null as VARCHAR(40)) as employee_number, cast(null as VARCHAR(13)) as employee_number_2, cast(null as VARCHAR(13)) as alternate_account_number, cast(null as DATE) as employment_date, cast(null as VARCHAR(01)) as employment_status_reason, cast(null as date) as enrollment_date, cast(null as DECIMAL(11,2)) as equity_wash_amount, cast(null as DECIMAL(11,2)) as er_after_tax, cast(null as DECIMAL(11,2)) as esop_diversification_shares, cast(null as DATE) as excess_trader_suspend_end_date, cast(null as VARCHAR(1)) as excess_trader_suspend_flag, cast(null as DATE) as excess_trader_susp_start_date, cast(null as VARCHAR(01)) as federal_part_marital_status, cast(null as VARCHAR(1)) as federal_w4p_form_status, cast(null as VARCHAR(1)) as financial_engins_prospect_code, cast(null as date) as first_contribution_date, cast(null as DATE) as first_default_contrib_date, cast(null as VARCHAR(1)) as flag_16B, cast(null as VARCHAR(3)) as foreign_country_code, cast(null as date) as free_look_end_date, cast(null as INTEGER) as gender, cast(null as VARCHAR(1)) as group_payment_status_flag, cast(null as INTEGER) as hce_indicator, cast(null as DECIMAL(11,2)) as high_loan_balance_amount, cast(null as INTEGER) as highly_compensated_ee_flag, cast(null as INTEGER) as hours_of_service, cast(null as INTEGER) as human_resouce_status_code, cast(null as DECIMAL(11,2)) as ilip_equity_wash_residual_amt, cast(null as DATE) as init_partial_term_dist_date, cast(null as DATE) as init_rollover_dist_date, cast(null as INTEGER) as inside_trading_16b_restrict_id, cast(null as INTEGER) as key_employee_indicator, cast(null as VARCHAR(3)) as language_print_preference, cast(null as DATE) as last_alloc_pct_change_date, cast(null as DATE) as last_contrib_rate_change_date, cast(lmia.gross_amount as DECIMAL(17,2)) as last_contribution_amt_gross, cast(null as DATE) as last_contribution_date, cast(null as DATE) as last_hardship_withdrawal_date, cast(null as DATE) as last_loan_default_date, cast(null as DATE) as last_plan_to_plan_transf_date, cast(null as DATE) as last_transfer_date, cast(null as DATE) as leave_of_absense_end_date, cast(null as DECIMAL(11,2)) as lifetime_dsc_amount, cast(null as DECIMAL(11,2)) as managed_acct_salary_at_enroll, cast(null as VARCHAR(5)) as match_payroll_generic_grouping, cast(null as VARCHAR(1)) as min_distrib_begin_time_option, cast(null as VARCHAR(1)) as min_distrib_calculation_method, cast(null as DATE) as min_distrib_eligibility_date, cast(null as VARCHAR(1)) as min_distrib_suppress_option, cast(null as DATE) as mva_charged_to_date, cast(null as DECIMAL(11,2)) as net_401k_elective_deferrals, cast(null as DATE) as next_rebalance_date, cast(null as VARCHAR(10)) as nonqual_ind, cast(null as VARCHAR(80)) as old_advice_account, cast(null as INTEGER) as oracle_plan_rule_id, cast(null as VARCHAR(1)) as override_withholding, cast(null as DECIMAL(11,2)) as override_withholding_amount, cast(null as DECIMAL(5,4)) as override_withholding_pct, cast(null as VARCHAR(2)) as part_acc_prod_code, cast(null as VARCHAR(20)) as part_acc_prod_shrt_nm, cast(null as VARCHAR(24)) as part_agg_sys_key, cast(null as VARCHAR(4)) as part_location_code, cast(null as VARCHAR(25)) as part_middle_name, cast(null as VARCHAR(5)) as part_payrole_location, cast(null as VARCHAR(32)) as part_phone, cast(null as VARCHAR(15)) as part_post88_surender, cast(null as VARCHAR(4)) as part_roth_year, cast(null as VARCHAR(10)) as part_suffix_title, cast(null as VARCHAR(13)) as part_sys_key, cast(null as VARCHAR(15)) as part_ytd_ee_contrib, cast(null as VARCHAR(15)) as part_ytd_er_contrib, cast(null as INTEGER) as part_ytd_hours_worked, cast(null as VARCHAR(1)) as participant_16b_status, case when n.part_acc_status in ('A','E','Z') then 'ACTIVE' when n.part_acc_status in ('N','F') then 'INACTIVE' when n.part_acc_status ='W'  then 'WAITING' end as participant_account_status_desc, cast(null as VARCHAR(55)) as participant_account_type, cast(null as VARCHAR(30)) as participant_account_type_code, cast(null as VARCHAR(30)) as participant_account_type_desc, cast(null as VARCHAR(40)) as participant_address_line_4, cast(null as VARCHAR(1)) as participant_catchup_eligible, cast(null as VARCHAR(13)) as participant_employee_id, cast(null as date) as participant_fe_end_date, cast(null as DATE) as participant_fe_start_date, cast(null as INTEGER) as participant_gender, cast(null as INTEGER) as participant_gender_code, cast(null as VARCHAR(1)) as participant_hce_status, cast(null as VARCHAR(1)) as participant_installment_status, cast(null as INTEGER) as participant_marital_status, cast(null as VARCHAR(40)) as participant_name_formatted, cast(null as VARCHAR(30)) as participant_name_protect, cast(null as INTEGER) as participant_person_flag, cast(null as VARCHAR(1)) as participant_qdro_status, cast(n.part_acc_status as VARCHAR(10)) as participant_status_code, cast(null as VARCHAR(3)) as pay_group_id, cast(null as VARCHAR(1)) as payroll_frequency, cast(null as INTEGER) as periods_of_continuous_service, cast(null as DECIMAL(15,2)) as plan_year_compensation_current, cast(null as VARCHAR(2)) as group_iv_id, cast(null as DECIMAL(15,2)) as plan_year_compensation_prior, cast(null as DECIMAL(11,2)) as post1986_ee_aftertax_contrib, cast(null as DECIMAL(11,2)) as pre_tax_401k_contrib_current, cast(null as DECIMAL(11,2)) as pre_tax_401k_contrib_prior, cast(null as DECIMAL(11,2)) as pre1987_ee_aftertax_contrib, cast(null as INTEGER) as prior_hce_indicator, cast(null as VARCHAR(3)) as puerto_rico_resident, cast(null as DATE) as qdia_date, cast(null as VARCHAR(1)) as qdia_indicator, cast(null as DECIMAL(11,2)) as qdro_beneficary_actual_ssn, cast(null as VARCHAR(1)) as qdro_flag, cast(null as VARCHAR(254)) as reduction_401k_option, cast(null as DATE) as reinstatement_notify_date, cast(null as VARCHAR(25)) as related_participant_id, cast(null as VARCHAR(1)) as roll_account_type, cast(null as DECIMAL(11,2)) as roll_contribution_current_year, cast(null as DECIMAL(11,2)) as roll_contribution_prior_year, cast(null as DECIMAL(11,2)) as roth_deferral_contributions, cast(null as DATE) as roth_first_contribution_date, cast(null as DECIMAL(11,2)) as roth_iprr_contributions, cast(null as VARCHAR(254)) as roth_sma_account_number, cast(null as DECIMAL(11,2)) as roth_unrestricted_contrib, cast(null as VARCHAR(1)) as sdbo_hold_harmless, cast(null as VARCHAR(1)) as sma_fund_balance, cast(null as DECIMAL(4,3)) as source_adj_vest_percent, cast(null as DATE) as source_cycle_date, cast(null as DATE) as source_processing_date, cast(null as DATE) as spouse_consent_expiration_date, cast(null as DATE) as spouse_birth_date, cast(null as VARCHAR(30)) as spouse_name, cast(null as DATE) as suspension_date, cast(null as INTEGER) as suspension_months_ee_contrib, cast(null as INTEGER) as suspension_months_er_contrib, cast(null as INTEGER) as suspension_months_forf_realloc, cast(null as VARCHAR(3)) as tax_treaty_country_code, cast(null as DATE) as termination_date, cast(null as DATE) as termination_notification_date, cast(null as VARCHAR(1)) as termination_reason_code, cast(null as INTEGER) as total_number_of_funds, cast(null as INTEGER) as trade_activity, cast(null as VARCHAR(254)) as very_important_person_indicat, cast(null as VARCHAR(1)) as withdrawal_restriction, cast(null as VARCHAR(1)) as withdrawal_restriction_reason,cast(null as DATE) as  last_crc_rate_chg_dt,cast(null as VARCHAR(2)) as term_stat_reason_code,cast(null AS VARCHAR(1)) as cntrbs_txd_by_st_flg,cast(null as DECIMAL(7,2)) as ee_cntrb_pty,cast(null as DECIMAL(7,2)) as ee_cntrb_ytd,cast('0.00' as DECIMAL(15,2)) as ytd_contributions from nw00paap_nlarc_prdps_partact_pdab_data as n FULL OUTER JOIN nw00paap_nlarc_prdps_pdab_lmia_data as lmia ON n.participant_acc_number=lmia.policy_number and n.plan_number=lmia.plan_number left outer join nw00paap_nlarc_prdps_plan_pdab_data q1 on n.plan_number=q1.plan_number
