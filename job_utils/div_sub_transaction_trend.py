
from pyspark.sql import SparkSession
from pyspark.sql.functions import *


def transform(spark: SparkSession, primary_key: list):

    exn_xxadsumt_xxadhsfx_2_jb_df = spark.sql("SELECT client_id, plan_number, cast(source_cycle_date AS DATE), cast(total_enrollments AS INTEGER), cast(total_employee_before_tax_contributions_count AS INTEGER) AS tl_emp_before_tax_contri_count, cast(total_employee_after_tax_contributions_count AS INTEGER) AS tot_emp_after_tax_contri_count, cast(total_employer_contributions_count AS INTEGER) AS total_employer_contrib_count, cast(total_rollover_contributions_count AS INTEGER) AS tot_rollover_contrib_count, cast(total_termination_distributions_with_rollover_count AS INTEGER) AS tot_term_distrib_roll_count, cast(total_termination_distributions_with_rollover_not_rolled_amount AS DECIMAL(14, 2)) AS tot_term_distrib_roll_not_roll, cast(total_termination_distributions_with_no_rollover_count AS INTEGER) AS tot_term_distrib_no_roll_count, cast(total_termination_distributions_with_no_rollover_amount AS DECIMAL(14, 2)) AS tot_term_distrib_no_roll_amt, cast(total_in_service_withdrawals_with_rollover_count AS INTEGER) AS tot_insrvc_withd_with_roll_cnt, cast(total_in_service_withdrawals_with_rollover_rolled_amount AS DECIMAL(14, 2)) AS tot_withd_roll_rolled_amt , cast(total_in_service_withdrawals_with_no_rollover_count AS INTEGER) AS tot_insrvc_withd_no_roll_count, cast(total_in_service_withdrawals_with_no_rollover_amount AS DECIMAL(14, 2)) AS tot_insrvc_withd_no_roll_amt, cast(total_hardship_withdrawals_count AS INTEGER) AS tot_hardship_withdrawals_count, cast(total_hardship_withdrawals_amount AS DECIMAL(14, 2)) AS tot_hardship_withdrawals_amt, total_installments_setup_count, cast(total_installment_distributions_by_check_count AS INTEGER) AS tot_install_distrib_check_cnt, cast(total_installment_distributions_by_check_amount AS DECIMAL(14, 2)) AS tot_install_distrib_check_amt, cast(total_installment_distributions_by_ach_count AS INTEGER) AS tot_install_distrib_ach_count, cast(total_installment_distributions_by_ach_amount AS DECIMAL(14, 2)) AS tot_install_distrib_ach_amt, cast(total_default_rollover_distributions_count AS INTEGER) AS tot_default_roll_distrib_count, cast(total_default_rollover_distributions_amount AS DECIMAL(14, 2)) AS tot_default_roll_distrib_amt, cast(total_deminimus_distributions_count AS INTEGER) AS tot_deminimus_distrib_count, cast(total_deminimus_distributions_amount AS DECIMAL(14, 2)) AS tot_deminimus_distrib_amt, cast(total_loan_issue_count AS INTEGER), cast(total_loan_reamortized_count AS INTEGER), cast(total_loan_defaults_deemed_distributions_count AS INTEGER) AS tot_loan_def_deemd_distrib_cnt, cast(total_loan_repayments_count AS INTEGER), total_loan_payoff_count, cast(total_dividend_pass_thru_count AS INTEGER), cast(total_dividend_pass_thru_amount AS DECIMAL(14, 2)) AS total_dividend_pass_thru_amt, cast(total_dividend_reinvestments_count AS INTEGER) AS tot_divid_reinvestments_count, cast(total_dividend_reinvestments_amount AS DECIMAL(14, 2)) AS tot_dividend_reinvestments_amt, cast(total_rebalance_transfers_count AS INTEGER) AS tot_rebal_xfer_count, cast(total_fee_deductions_count AS INTEGER), cast(total_qdro_splits_count AS INTEGER), cast(total_beneficiary_splits_count AS INTEGER), cast(total_rmd_count AS INTEGER), cast(total_rmd_amount AS DECIMAL(14, 2)), div_sub_id, cast(total_cash_earnings_count AS DECIMAL(14, 2)), cast(total_cash_earnings_amount AS DECIMAL(14, 2)), cast(tot_unreal_earn_cnt2 AS INTEGER), cast(tot_unreal_earn_amt2 AS DECIMAL(14, 2)), cast(tot_div_cnt2 AS INTEGER), cast(tot_div_amt2 AS DECIMAL(14, 2)), cast(tot_earn_base_fct_cnt2 AS INTEGER), cast(tot_earn_base_fct_amt2 AS DECIMAL(14, 2)), cast(total_fee_count AS INTEGER), cast(total_fee_amount AS DECIMAL(14, 2)), cast(tot_inter_ppt_to_cnt2 AS INTEGER), cast(tot_inter_ppt_to_amt2 AS DECIMAL(14, 2)), cast(tot_inter_ppt_frm_cnt2 AS INTEGER), cast(tot_inter_ppt_frm_amt2 AS DECIMAL(14, 2)), cast(tot_inter_ppt_rel_cnt2 AS INTEGER), cast(tot_inter_ppt_rel_amt2 AS DECIMAL(14, 2)), cast(tot_loan_reamrt_cnt2 AS INTEGER), cast(tot_loan_reamrt_amt2 AS DECIMAL(14, 2)), cast(tot_loan_ramrt_rt_cnt2 AS INTEGER), cast(tot_loan_ramrt_rt_amt2 AS DECIMAL(14, 2)), cast(tot_accord_int_cnt2 AS INTEGER), cast(tot_accord_int_amt2 AS DECIMAL(14, 2)), cast(tot_rtrn_excss_cnt2 AS INTEGER), cast(tot_rtrn_excss_amt2 AS DECIMAL(14, 2)), cast(tot_rtrn_excss_wd_cnt2 AS INTEGER), cast(tot_rtrn_excss_wd_amt2 AS DECIMAL(14, 2)), cast(tot_enrl_dem_cnt2 AS INTEGER), cast(total_in_service_withdrawals_with_rollover_not_rolled_amount AS DECIMAL(14, 2)) AS tot_withd_roll_not_rolled_amt, cast(tot_enrl_elec_cnt2 AS INTEGER), cast(tot_dem_updt_cnt2 AS INTEGER), cast(tot_inv_elec_cnt2 AS INTEGER), cast(total_termination_distributions_with_rollover_rolled_amount AS DECIMAL(14, 2)) AS tot_term_distrib_roll_rolled, cast(total_loan_issue_amount AS DECIMAL(14, 2)) FROM exn_xxadsumt_xxadhsfx_2_jb")
    exn_xxadsumt_xxadhsfx_2_jb_df = exn_xxadsumt_xxadhsfx_2_jb_df.withColumn('source_system', lit('VRP-SP'))

    transform_df = exn_xxadsumt_xxadhsfx_2_jb_df

    return transform_df